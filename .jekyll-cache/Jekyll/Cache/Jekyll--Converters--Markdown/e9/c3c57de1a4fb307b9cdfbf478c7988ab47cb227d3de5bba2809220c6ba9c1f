I"îG<p>åŒæ­¥åŸè¯­åˆå«synchronization primitivesï¼Œæˆ‘ä»¬éƒ½çŸ¥é“åœ¨Javaä¸­ï¼Œå¤šçº¿ç¨‹æ›´æ–°å…±äº«èµ„æºæ—¶ï¼Œéœ€è¦é”å»ä¿è¯å…±äº«èµ„æºçš„ä¸€è‡´æ€§ã€‚é”(Lock)å°±æ˜¯synchronization primitivesä¸­çš„ä¸€ç§ã€‚synchronization primitivesä¸»è¦æ˜¯ç”¨æ¥å®ç°â€åŒæ­¥â€ã€‚</p>

<p>æŒ‰ç…§ç±»åˆ«åˆ’åˆ†ï¼Œsynchronization primitiveså¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ ç§:</p>

<ul>
  <li>semaphores</li>
  <li>mutex</li>
  <li>locks</li>
  <li>binary semaphore</li>
  <li>events</li>
  <li>signals</li>
  <li>condition variables</li>
  <li>monitors</li>
</ul>

<p>ä¸Šé¢çš„åˆ†ç±»å‡ºè‡ªå“¥ä¼¦æ¯”äºšå¤§å­¦ç½‘ç«™çš„ä¸€ç¯‡æ–‡ç« ï¼Œç‚¹å‡»è¿›å…¥<a href="http://www.cs.columbia.edu/~hgs/os/sync.html">Synchronization primitives</a>ã€‚ç²¾åŠ›æœ‰é™ï¼Œæœ¬æ–‡ä»…ä»‹ç»Mutexå’ŒSemaphoresã€‚</p>

<!--more-->

<h3 id="mutex--lock">Mutex &amp; Lock</h3>

<p>æˆ‘ä»¬å¯ä»¥æŠŠMutexå’ŒLockå½“ä½œæ˜¯ä¸€ç§ä¸œè¥¿ã€‚äº’æ–¥åœ¨Javaä¸­å¾ˆå¸¸è§ï¼ŒJDKæä¾›çš„synchronizedå…³é”®å­—ï¼Œåœ¨JVMå±‚é¢æä¾›äº†äº’æ–¥; ä»¥åŠåæ¥Doug Leaæäº¤çš„Concurrent utilsä¸­çš„ReentrantLockï¼Œéƒ½æ˜¯Mutexçš„å®ç°ã€‚</p>

<p>mutex(lock)é€šå¸¸ä¼šæä¾›lockå’Œunlockæ“ä½œï¼Œå®ƒæœ€å¤§çš„ç‰¹ç‚¹å°±æ˜¯â€æ’ä»–â€ï¼Œå½“å¤šä¸ªçº¿ç¨‹è¿›å…¥ä¸´ç•ŒåŒº(critical section)çš„ä»£ç æ—¶ï¼ŒåŒä¸€æ—¶é—´åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½è·å¾—å¯¹é”ï¼Œä¸”åªæœ‰è·å¾—é”çš„çº¿ç¨‹æ‰èƒ½æ‰§è¡Œunlockæ“ä½œï¼Œå…¶ä»–çº¿ç¨‹å¿…é¡»ç­‰æ‹¥æœ‰é”çš„çº¿ç¨‹æ‰§è¡Œäº†unlockæ“ä½œï¼Œæ‰èƒ½è·å¾—é”ã€‚</p>

<p>åœ¨Javaä¸­ï¼ŒMutexæ˜¯å¾ˆå¸¸è§çš„æ“ä½œï¼Œä¸‹é¢çš„inc()å’Œinc2()éƒ½èƒ½ä¿è¯mutexï¼Œç›¸ä¿¡æ¯ä¸ªæœ‰ç»éªŒçš„Javaç¨‹åºå‘˜éƒ½éå¸¸ç†Ÿæ‚‰ã€‚</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MutexDemo</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">Lock</span> <span class="n">lock</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ReentrantLock</span><span class="o">();</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="n">shareVariable</span><span class="o">;</span>
    
    <span class="kd">public</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">inc</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">shareVariable</span> <span class="o">+=</span> <span class="mi">1</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">inc2</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">lock</span><span class="o">.</span><span class="na">lock</span><span class="o">();</span>
            <span class="n">shareVariable</span> <span class="o">+=</span> <span class="mi">1</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
            <span class="n">lock</span><span class="o">.</span><span class="na">unlock</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="semaphores">Semaphores</h3>

<p>Semaphoresä¸­æ–‡åå«ä¿¡å·é‡ï¼Œç”¨äºè§£å†³å¹¶å‘ç³»ç»Ÿä¸­å¤šä¸ªè¿›ç¨‹(æˆ–çº¿ç¨‹)å¯¹å…¬å…±èµ„æºçš„è®¿é—®</p>

<blockquote>
  <p>In computer science, a semaphore is a variable or abstract data type used to control access to a common resource by multiple processes in a concurrent system such as a multitasking operating system.</p>
</blockquote>

<p>çœ‹å®Œä¸Šé¢çš„å®šä¹‰ï¼Œä½ å¥½åƒåˆè§‰å¾—å®ƒè·ŸLockæ²¡ä»€ä¹ˆå¤ªå¤§çš„ä¸åŒï¼Œç»´åŸºç™¾ç§‘è¿˜æœ‰ä¸€æ®µå®šä¹‰ã€‚</p>

<blockquote>
  <p>A semaphore is simply a variable. This variable is used to solve critical section problems and to achieve process synchronization in the multi processing environment. A trivial semaphore is a plain variable that is changed (for example, incremented or decremented, or toggled) depending on programmer-defined conditions.</p>
</blockquote>

<p>semaphoreæ˜¯ä¸€ä¸ª<strong>æ™®é€šçš„å˜é‡</strong>ï¼Œå®ƒç”¨æ¥è§£å†³ä¸´ç•ŒåŒºçš„é—®é¢˜ï¼Œå’Œå®ç°å¤šè¿›ç¨‹(çº¿ç¨‹)çš„åŒæ­¥é—®é¢˜ã€‚å…·ä½“çš„æ“ä½œæ˜¯åœ¨ä¸€å®šçš„æ¡ä»¶ä¸‹ï¼Œé€šè¿‡incrementedå’Œdecrementedè¿™ä¸ªå˜é‡æ¥å®ç°åŒæ­¥ã€‚</p>

<p>semaphoreå’Œmutexæœ€å¤§çš„åŒºåˆ«æ˜¯ï¼Œå®ƒå…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®å…¬å…±çš„èµ„æºã€‚ç»´åŸºç™¾ç§‘è¿˜æœ‰ä¸€ä¸ªä¾‹å­ï¼Œæ˜¯å…³äºè‡ªä¹ å®¤çš„ã€‚</p>

<blockquote>
  <p>Suppose a library has 10 identical study rooms, to be used by one student at a time. Students must request a room from the front desk if they wish to use a study room. If no rooms are free, students wait at the desk until someone relinquishes a room. When a student has finished using a room, the student must return to the desk and indicate that one room has become free.</p>

  <p>å®Œæ•´çš„ä¾‹å­:  <a href="https://en.wikipedia.org/wiki/Semaphore_(programming)">https://en.wikipedia.org/wiki/Semaphore_(programming)</a></p>
</blockquote>

<p>å‡å¦‚ä¸€ä¸ªå›¾ä¹¦é¦†æœ‰10ä¸ªè‡ªä¹ å®¤ï¼Œä¸€ä¸ªè‡ªä¹ å®¤åŒä¸€æ—¶é—´åªèƒ½æœ‰è¢«ä¸€ä¸ªå­¦ç”Ÿä½¿ç”¨ã€‚å¦‚æœå­¦ç”Ÿæƒ³ä½¿ç”¨è‡ªä¹ å®¤ï¼Œå¿…é¡»è¦å‘å‰å°ç”³è¯·ï¼Œå¦‚æœæ²¡æœ‰å¯ç”¨çš„è‡ªä¹ å®¤ï¼Œé‚£ä¹ˆå­¦ç”Ÿå¿…é¡»è¦ç­‰å…¶ä»–äººå­¦å®Œåï¼Œæ‰èƒ½ä½¿ç”¨ã€‚</p>

<p>å¬èµ·æ¥ååˆ†åƒAQSä¸­çš„Shared Lockï¼Œæˆ‘ä»¬å†™ä¸ªä¾‹å­æ¥å®ç°ä¸Šé¢çš„ä¾‹å­ã€‚è¿™é‡ŒæŠŠè‡ªä¹ å®¤æ”¹ä¸º2ä¸ªï¼Œä¸€å…±3ä¸ªäººæƒ³è¦è·å–è‡ªä¹ å®¤ã€‚</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SemaphoreDemo</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">Semaphore</span> <span class="n">semaphore</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Semaphore</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="nc">ExecutorService</span> <span class="n">es</span> <span class="o">=</span> <span class="nc">Executors</span><span class="o">.</span><span class="na">newFixedThreadPool</span><span class="o">(</span><span class="mi">3</span><span class="o">);</span>
        <span class="n">es</span><span class="o">.</span><span class="na">submit</span><span class="o">(</span><span class="nl">SemaphoreDemo:</span><span class="o">:</span><span class="n">execute</span><span class="o">);</span>
        <span class="n">es</span><span class="o">.</span><span class="na">submit</span><span class="o">(</span><span class="nl">SemaphoreDemo:</span><span class="o">:</span><span class="n">execute</span><span class="o">);</span>
      	<span class="n">es</span><span class="o">.</span><span class="na">submit</span><span class="o">(</span><span class="nl">SemaphoreDemo:</span><span class="o">:</span><span class="n">execute</span><span class="o">);</span>

        <span class="nc">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="mi">3</span><span class="o">);</span>
        <span class="n">es</span><span class="o">.</span><span class="na">shutdown</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">execute</span><span class="o">(){</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">semaphore</span><span class="o">.</span><span class="na">acquire</span><span class="o">();</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">"çº¿ç¨‹ %s è·å–åˆ°é”\n"</span><span class="o">,</span><span class="nc">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">().</span><span class="na">getName</span><span class="o">());</span>
            <span class="nc">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">"çº¿ç¨‹ %s é‡Šæ”¾é”\n"</span><span class="o">,</span><span class="nc">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">().</span><span class="na">getName</span><span class="o">());</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
            <span class="n">semaphore</span><span class="o">.</span><span class="na">release</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="c1">//Output</span>
<span class="cm">/**
 * çº¿ç¨‹ pool-1-thread-1 è·å–åˆ°é”
 * çº¿ç¨‹ pool-1-thread-2 è·å–åˆ°é”
 * çº¿ç¨‹ pool-1-thread-1 é‡Šæ”¾é”
 * çº¿ç¨‹ pool-1-thread-2 é‡Šæ”¾é”
 * çº¿ç¨‹ pool-1-thread-3 è·å–åˆ°é”
 * çº¿ç¨‹ pool-1-thread-3 é‡Šæ”¾é”
 */</span>
</code></pre></div></div>

<p>ä»ä¸Šé¢çš„è¾“å‡ºæ¥çœ‹ï¼Œçº¿ç¨‹2å¹¶æ²¡æœ‰åœ¨çº¿ç¨‹1ç¨‹è·å¾—é”åå‘ç”Ÿé˜»å¡ï¼Œå› ä¸ºæˆ‘ä»¬åˆ›å»ºSemaphoreæ—¶ï¼Œpermits value ä¸º2ï¼Œè¡¨ç¤ºåŒæ—¶èƒ½æœ‰2ä¸ªçº¿ç¨‹è·å¾—é”ï¼Œå› æ­¤çº¿ç¨‹3å¿…é¡»ç­‰å¾…å‰ä¸¤ä¸ªçº¿ç¨‹å…¶ä¸­ä¸€ä¸ªé‡Šæ”¾æ‰èƒ½è·å–é”ã€‚</p>

<p>ç†Ÿæ‚‰AQSçš„æœ‹å‹éƒ½çŸ¥é“ï¼Œshare lockæœ¬è´¨æ˜¯é€šè¿‡æ“ä½œAQSçš„stateå®ç°çš„ï¼Œä¸‹é¢æ˜¯Javaä¸­Semaphoreç±»çš„æ“ä½œã€‚</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">final</span> <span class="kt">int</span> <span class="nf">nonfairTryAcquireShared</span><span class="o">(</span><span class="kt">int</span> <span class="n">acquires</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">for</span> <span class="o">(;;)</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">available</span> <span class="o">=</span> <span class="n">getState</span><span class="o">();</span>
    <span class="kt">int</span> <span class="n">remaining</span> <span class="o">=</span> <span class="n">available</span> <span class="o">-</span> <span class="n">acquires</span><span class="o">;</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">remaining</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span>
        <span class="n">compareAndSetState</span><span class="o">(</span><span class="n">available</span><span class="o">,</span> <span class="n">remaining</span><span class="o">))</span>
      <span class="k">return</span> <span class="n">remaining</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="kd">protected</span> <span class="kd">final</span> <span class="kt">boolean</span> <span class="nf">tryReleaseShared</span><span class="o">(</span><span class="kt">int</span> <span class="n">releases</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">for</span> <span class="o">(;;)</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">current</span> <span class="o">=</span> <span class="n">getState</span><span class="o">();</span>
    <span class="kt">int</span> <span class="n">next</span> <span class="o">=</span> <span class="n">current</span> <span class="o">+</span> <span class="n">releases</span><span class="o">;</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">next</span> <span class="o">&lt;</span> <span class="n">current</span><span class="o">)</span> <span class="c1">// overflow</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nf">Error</span><span class="o">(</span><span class="s">"Maximum permit count exceeded"</span><span class="o">);</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">compareAndSetState</span><span class="o">(</span><span class="n">current</span><span class="o">,</span> <span class="n">next</span><span class="o">))</span>
      <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="binary-semaphoreså’Œmutex">Binary Semaphoreså’ŒMutex</h3>

<p>é€šè¿‡ä¸Šé¢çš„ä»‹ç»ï¼Œæˆ–è®¸ä½ ä¼šæƒ³åˆ°ï¼Œå½“semaphoresçš„permits valueä¸º1æ—¶ï¼Œä¸å°±èƒ½è¾¾åˆ°äº’æ–¥äº†å—ï¼Ÿç¡®å®æ˜¯è¿™æ ·çš„ï¼Œè¿™æ ·ä¹Ÿå«<strong>binary semaphore</strong>ï¼Œå¯ä»¥ç”¨æ¥å®ç°äº’æ–¥ã€‚æ¯”å¦‚ä¸‹é¢ä»£ç å°±å¯ä»¥è¾¾åˆ°ç±»ä¼¼äºäº’æ–¥çš„æ•ˆæœã€‚</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">BinarySemaphoreDemo</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">Semaphore</span> <span class="n">semaphore</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Semaphore</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="n">shareVariable</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="nc">ExecutorService</span> <span class="n">es</span> <span class="o">=</span> <span class="nc">Executors</span><span class="o">.</span><span class="na">newFixedThreadPool</span><span class="o">(</span><span class="mi">10</span><span class="o">);</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">10</span><span class="o">;</span><span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">es</span><span class="o">.</span><span class="na">submit</span><span class="o">(</span><span class="nl">BinarySemaphoreDemo:</span><span class="o">:</span><span class="n">fakeMutex</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="n">es</span><span class="o">.</span><span class="na">awaitTermination</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span><span class="nc">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">"shareVariable = %d\n"</span><span class="o">,</span><span class="n">shareVariable</span><span class="o">);</span>
        <span class="n">es</span><span class="o">.</span><span class="na">shutdown</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">fakeMutex</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">semaphore</span><span class="o">.</span><span class="na">acquire</span><span class="o">();</span>
            <span class="n">shareVariable</span> <span class="o">+=</span> <span class="mi">1</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
            <span class="n">semaphore</span><span class="o">.</span><span class="na">release</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="c1">//output </span>
<span class="c1">//shareVariable = 10</span>
</code></pre></div></div>

<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸Šé¢ä»£ç ä¸æ˜¯çœŸæ­£çš„äº’æ–¥ï¼Œå› ä¸ºJUCä¸‹çš„Semaphoreç±»å¹¶æ²¡æœ‰é™åˆ¶å…¶ä»–çº¿ç¨‹å»releaseã€‚å¦‚æœè¦å®ç°çœŸæ­£çš„äº’æ–¥ï¼Œè¿˜éœ€è¦è‡ªå·±æ‰©å±•åŠŸèƒ½ã€‚</p>

<p>è™½ç„¶å®ƒèƒ½å®ç°äº’æ–¥ï¼Œä¸è¿‡ä¸€èˆ¬æˆ‘ä»¬ä¸ä¼šè¿™ä¹ˆå»åšï¼Œå› ä¸ºå®ƒæœ¬æ¥å°±ä¸æ˜¯è®¾è®¡ä¸ºäº’æ–¥çš„ï¼Œå½“ä½ çš„ç¨‹åºéœ€è¦ç”¨åˆ°äº’æ–¥æ—¶ï¼Œè¯·ä½¿ç”¨ReentrantLockã€‚</p>

<h3 id="ç»“è¯­">ç»“è¯­</h3>

<p>synchronization primitivesåªæ˜¯ä¸€äº›æ¦‚å¿µï¼Œä¸è¦ä»¥ä¸ºåªæ˜¯åœ¨Javaä¸­å­˜åœ¨ï¼ŒJavaä¸­çš„synchronizedå…³é”®å­—å’ŒReentrantLockéƒ½æ˜¯synchronization primitivesçš„ä¸€äº›å®ç°ã€‚åŒæ ·çš„ä¸œè¥¿ï¼Œä¹Ÿä¼šå‡ºç°åœ¨linuxï¼Œwindowsç­‰æ“ä½œç³»ç»Ÿä¸Šã€‚</p>

<p>semaphoreå’Œmutexå…±åŒçš„ç›®æ ‡éƒ½æ˜¯å®ç°synchronizationï¼Œåªæ˜¯ä»–ä»¬çš„ä½¿ç”¨åœºæ™¯ä¸å¤ªä¸€æ ·ã€‚mutexç”¨äºäº’æ–¥çš„åœºæ™¯ï¼Œsemaphoreæ›´å€¾å‘äºçº¿ç¨‹ä¹‹é—´çš„è°ƒåº¦ã€‚</p>
:ET